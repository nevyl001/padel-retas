{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{getGames,createGame,updateGame,deleteGame,getPairs}from\"../lib/database\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const MatchScoreEditor=_ref=>{let{match,onClose,onMatchFinish}=_ref;const[games,setGames]=useState([]);const[pairs,setPairs]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(\"\");// Cargar juegos y parejas al montar el componente\nuseEffect(()=>{const loadData=async()=>{try{console.log(\"🔄 Cargando datos del editor de marcador...\");// Cargar juegos del partido\nconst matchGames=await getGames(match.id);console.log(`📊 Juegos cargados: ${matchGames.length}`);setGames(matchGames);// Cargar parejas del torneo\nconst allPairs=await getPairs(match.tournament_id);console.log(`👥 Parejas cargadas: ${allPairs.length}`);setPairs(allPairs);}catch(err){console.error(\"❌ Error cargando datos:\",err);setError(\"Error al cargar los datos\");}};loadData();},[match.id,match.tournament_id]);// Agregar nuevo juego\nconst addGame=async()=>{try{setLoading(true);setError(\"\");console.log(`➕ Agregando juego ${games.length+1} al partido ${match.id}`);const newGame=await createGame(match.id,games.length+1);console.log(`✅ Juego creado: ${newGame.id}`);setGames(prevGames=>{const updatedGames=[...prevGames,newGame];console.log(`📊 Total de juegos después de agregar: ${updatedGames.length}`);return updatedGames;});}catch(err){console.error(\"❌ Error agregando juego:\",err);setError(\"Error al agregar juego\");}finally{setLoading(false);}};// CORREGIR puntuación de un juego específico (NO acumula estadísticas)\nconst correctGameScore=async function(gameId,pair1Games,pair2Games){let isTieBreak=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;try{console.log(`🔄 CORRIGIENDO juego ${gameId}: ${pair1Games}-${pair2Games}`);console.log(`📊 Juegos antes de corregir: ${games.length}`);// SOLO actualizar el juego en la base de datos\nawait updateGame(gameId,{pair1_games:pair1Games,pair2_games:pair2Games,is_tie_break:isTieBreak});// Actualizar estado local\nsetGames(prevGames=>{const updatedGames=prevGames.map(game=>game.id===gameId?{...game,pair1_games:pair1Games,pair2_games:pair2Games,is_tie_break:isTieBreak}:game);console.log(`📊 Juegos después de corregir: ${updatedGames.length}`);console.log(`✅ Juego ${gameId} corregido correctamente - NO se acumularon estadísticas`);return updatedGames;});// CRÍTICO: NO llamar a onMatchFinish() aquí\n// Solo se llama cuando se finaliza el partido\nconsole.log(\"🚫 NO se llama onMatchFinish() al corregir juego\");}catch(err){console.error(\"❌ Error corrigiendo juego:\",err);setError(\"Error al corregir puntuación\");}};// Eliminar juego\nconst removeGame=async gameId=>{try{setLoading(true);setError(\"\");console.log(`🗑️ Eliminando juego ${gameId}`);await deleteGame(gameId);setGames(prevGames=>{const updatedGames=prevGames.filter(game=>game.id!==gameId);console.log(`📊 Juegos después de eliminar: ${updatedGames.length}`);return updatedGames;});// CRÍTICO: NO llamar a onMatchFinish() aquí\nconsole.log(\"🚫 NO se llama onMatchFinish() al eliminar juego\");}catch(err){console.error(\"❌ Error eliminando juego:\",err);setError(\"Error al eliminar juego\");}finally{setLoading(false);}};// Cambiar tipo de juego (normal/tie-break)\nconst toggleTieBreak=async gameId=>{const game=games.find(g=>g.id===gameId);if(game){await correctGameScore(gameId,game.pair1_games,game.pair2_games,!game.is_tie_break);}};// RECALCULAR todas las estadísticas del torneo desde cero\nconst recalculateAllTournamentStatistics=async()=>{try{console.log(\"🔄 RECALCULANDO todas las estadísticas del torneo...\");// Obtener todos los partidos del torneo\nconst{getMatches}=await import(\"../lib/database\");const allMatches=await getMatches(match.tournament_id);const finishedMatches=allMatches.filter(m=>m.is_finished);console.log(`📊 Partidos finalizados encontrados: ${finishedMatches.length}`);// Resetear todas las estadísticas de las parejas a cero\nconst{updatePair}=await import(\"../lib/database\");for(const pair of pairs){var _pair$player,_pair$player2;await updatePair(pair.id,{games_won:0,sets_won:0,points:0,matches_played:0});console.log(`🔄 Reseteadas estadísticas de ${(_pair$player=pair.player1)===null||_pair$player===void 0?void 0:_pair$player.name} y ${(_pair$player2=pair.player2)===null||_pair$player2===void 0?void 0:_pair$player2.name}`);}// Recalcular estadísticas de cada partido finalizado\nfor(const finishedMatch of finishedMatches){const matchGames=await getGames(finishedMatch.id);let pair1TotalPoints=0;let pair2TotalPoints=0;let pair1GamesWon=0;let pair2GamesWon=0;let pair1SetsWon=0;let pair2SetsWon=0;// Calcular estadísticas del partido\nmatchGames.forEach(game=>{if(game.is_tie_break){// Tie-break\nif(game.tie_break_pair1_points>game.tie_break_pair2_points){pair1GamesWon++;}else if(game.tie_break_pair2_points>game.tie_break_pair1_points){pair2GamesWon++;}pair1TotalPoints+=game.tie_break_pair1_points||0;pair2TotalPoints+=game.tie_break_pair2_points||0;}else{// Juego normal\nif(game.pair1_games>game.pair2_games){pair1GamesWon++;}else if(game.pair2_games>game.pair1_games){pair2GamesWon++;}pair1TotalPoints+=game.pair1_games;pair2TotalPoints+=game.pair2_games;// Sets (6 puntos = 1 set)\nif(game.pair1_games>=6){pair1SetsWon++;}if(game.pair2_games>=6){pair2SetsWon++;}}});// Acumular estadísticas en las parejas\nconst pair1=pairs.find(p=>p.id===finishedMatch.pair1_id);const pair2=pairs.find(p=>p.id===finishedMatch.pair2_id);if(pair1){const currentPair1=await getPairs(match.tournament_id);const updatedPair1=currentPair1.find(p=>p.id===pair1.id);if(updatedPair1){await updatePair(pair1.id,{games_won:updatedPair1.games_won+pair1GamesWon,sets_won:updatedPair1.sets_won+pair1SetsWon,points:updatedPair1.points+pair1TotalPoints,matches_played:updatedPair1.matches_played+1});}}if(pair2){const currentPair2=await getPairs(match.tournament_id);const updatedPair2=currentPair2.find(p=>p.id===pair2.id);if(updatedPair2){await updatePair(pair2.id,{games_won:updatedPair2.games_won+pair2GamesWon,sets_won:updatedPair2.sets_won+pair2SetsWon,points:updatedPair2.points+pair2TotalPoints,matches_played:updatedPair2.matches_played+1});}}console.log(`✅ Partido ${finishedMatch.id} recalculado`);}console.log(\"✅ Todas las estadísticas del torneo recalculadas correctamente\");}catch(err){console.error(\"❌ Error recalculando estadísticas:\",err);setError(\"Error al recalcular estadísticas\");}};// FINALIZAR partido (recalcula todas las estadísticas)\nconst finishMatch=async()=>{try{setLoading(true);setError(\"\");console.log(\"🏆 FINALIZANDO partido...\");// Calcular estadísticas del partido actual\nlet pair1TotalPoints=0;let pair2TotalPoints=0;let pair1GamesWon=0;let pair2GamesWon=0;let pair1SetsWon=0;let pair2SetsWon=0;games.forEach((game,index)=>{console.log(`📊 Procesando juego ${index+1}: ${game.pair1_games}-${game.pair2_games}`);if(game.is_tie_break){// Tie-break\nif(game.tie_break_pair1_points>game.tie_break_pair2_points){pair1GamesWon++;}else if(game.tie_break_pair2_points>game.tie_break_pair1_points){pair2GamesWon++;}pair1TotalPoints+=game.tie_break_pair1_points||0;pair2TotalPoints+=game.tie_break_pair2_points||0;}else{// Juego normal\nif(game.pair1_games>game.pair2_games){pair1GamesWon++;}else if(game.pair2_games>game.pair1_games){pair2GamesWon++;}pair1TotalPoints+=game.pair1_games;pair2TotalPoints+=game.pair2_games;// Sets (6 puntos = 1 set)\nif(game.pair1_games>=6){pair1SetsWon++;}if(game.pair2_games>=6){pair2SetsWon++;}}});console.log(\"📊 Estadísticas finales del partido:\");console.log(`📊 Pareja 1: ${pair1GamesWon} juegos, ${pair1SetsWon} sets, ${pair1TotalPoints} puntos`);console.log(`📊 Pareja 2: ${pair2GamesWon} juegos, ${pair2SetsWon} sets, ${pair2TotalPoints} puntos`);// Determinar ganador\nlet winnerId;const isTie=pair1TotalPoints===pair2TotalPoints;if(isTie){winnerId=undefined;console.log(\"🤝 Partido terminó en EMPATE\");}else if(pair1TotalPoints>pair2TotalPoints){winnerId=match.pair1_id;console.log(\"🏆 Pareja 1 gana por puntos totales\");}else{winnerId=match.pair2_id;console.log(\"🏆 Pareja 2 gana por puntos totales\");}// Marcar partido como finalizado\nconst{updateMatch}=await import(\"../lib/database\");await updateMatch(match.id,{winner_id:winnerId,is_finished:true});console.log(\"✅ Partido finalizado correctamente\");// RECALCULAR todas las estadísticas del torneo\nawait recalculateAllTournamentStatistics();// Llamar onMatchFinish() para actualizar tabla\nconsole.log(\"🏆 Llamando onMatchFinish() para actualizar tabla de clasificación\");onMatchFinish();onClose();}catch(err){console.error(\"❌ Error finalizando partido:\",err);setError(\"Error al finalizar partido\");}finally{setLoading(false);}};// Obtener nombres de pareja\nconst getPairNames=pairId=>{const pair=pairs.find(p=>p.id===pairId);if(pair){var _pair$player3,_pair$player4;return`${((_pair$player3=pair.player1)===null||_pair$player3===void 0?void 0:_pair$player3.name)||\"Jugador 1\"} y ${((_pair$player4=pair.player2)===null||_pair$player4===void 0?void 0:_pair$player4.name)||\"Jugador 2\"}`;}return\"Pareja desconocida\";};return/*#__PURE__*/_jsx(\"div\",{className:\"match-score-editor-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-modal\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"match-score-editor-icon\",children:\"\\uD83C\\uDFBE\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"Editor de Marcador\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"match-score-editor-close-btn\",onClick:onClose,children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-info\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Partido \",match.court,\" - Ronda \",match.round]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-pairs\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-pair\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"match-score-editor-pair-label\",children:\"\\uD83C\\uDFC6 Pareja 1:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"match-score-editor-pair-names\",children:getPairNames(match.pair1_id)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-pair\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"match-score-editor-pair-label\",children:\"\\uD83C\\uDFC6 Pareja 2:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"match-score-editor-pair-names\",children:getPairNames(match.pair2_id)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-rules\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"\\uD83D\\uDCCB Reglas del Juego:\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Juegos:\"}),\" La pareja que haga m\\xE1s puntos gana el juego\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Sets:\"}),\" La pareja que llegue a 6 puntos gana 1 set\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Empates:\"}),\" Si ambas parejas tienen los mismos puntos, es empate\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Tie-Breaks:\"}),\" Se pueden activar para desempates especiales\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-games-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-games-header\",children:[/*#__PURE__*/_jsxs(\"h5\",{children:[\"\\uD83C\\uDFBE Juegos (\",games.length,\")\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"match-score-editor-add-game-btn\",onClick:addGame,disabled:loading,children:\"+ Agregar Juego\"})]}),games.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"match-score-editor-no-games\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No hay juegos registrados. Haz clic en \\\"Agregar Juego\\\" para comenzar.\"})}):/*#__PURE__*/_jsx(\"div\",{className:\"match-score-editor-games-list\",children:games.map((game,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-game-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-game-header\",children:[/*#__PURE__*/_jsxs(\"h6\",{children:[\"Juego \",index+1]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-game-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"match-score-editor-tie-break-btn\",onClick:()=>toggleTieBreak(game.id),children:game.is_tie_break?\"🔗 Tie-Break\":\"🔗 Normal\"}),/*#__PURE__*/_jsx(\"button\",{className:\"match-score-editor-remove-game-btn\",onClick:()=>removeGame(game.id),children:\"\\uD83D\\uDDD1\\uFE0F Eliminar\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-game-scores\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-score-input\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"match-score-editor-pair-name-label\",children:getPairNames(match.pair1_id)}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:game.pair1_games,onChange:e=>correctGameScore(game.id,parseInt(e.target.value)||0,game.pair2_games,game.is_tie_break)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"match-score-editor-score-separator\",children:\"-\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-score-input\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"match-score-editor-pair-name-label\",children:getPairNames(match.pair2_id)}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",value:game.pair2_games,onChange:e=>correctGameScore(game.id,game.pair1_games,parseInt(e.target.value)||0,game.is_tie_break)})]})]})]},game.id))})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"match-score-editor-error\",children:/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u274C \",error]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-score-editor-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"match-score-editor-finish-btn\",onClick:finishMatch,disabled:loading||games.length===0,children:loading?\"⏳ Finalizando...\":\"🏆 Finalizar Partido\"}),/*#__PURE__*/_jsx(\"button\",{className:\"match-score-editor-cancel-btn\",onClick:onClose,children:\"\\u274C Cancelar\"})]})]})]})});};","map":{"version":3,"names":["React","useState","useEffect","getGames","createGame","updateGame","deleteGame","getPairs","jsx","_jsx","jsxs","_jsxs","MatchScoreEditor","_ref","match","onClose","onMatchFinish","games","setGames","pairs","setPairs","loading","setLoading","error","setError","loadData","console","log","matchGames","id","length","allPairs","tournament_id","err","addGame","newGame","prevGames","updatedGames","correctGameScore","gameId","pair1Games","pair2Games","isTieBreak","arguments","undefined","pair1_games","pair2_games","is_tie_break","map","game","removeGame","filter","toggleTieBreak","find","g","recalculateAllTournamentStatistics","getMatches","allMatches","finishedMatches","m","is_finished","updatePair","pair","_pair$player","_pair$player2","games_won","sets_won","points","matches_played","player1","name","player2","finishedMatch","pair1TotalPoints","pair2TotalPoints","pair1GamesWon","pair2GamesWon","pair1SetsWon","pair2SetsWon","forEach","tie_break_pair1_points","tie_break_pair2_points","pair1","p","pair1_id","pair2","pair2_id","currentPair1","updatedPair1","currentPair2","updatedPair2","finishMatch","index","winnerId","isTie","updateMatch","winner_id","getPairNames","pairId","_pair$player3","_pair$player4","className","children","onClick","court","round","disabled","type","min","value","onChange","e","parseInt","target"],"sources":["/Users/nedev/padel-tournament-app/src/components/MatchScoreEditor.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Match, Game, Pair } from \"../lib/database\";\nimport {\n  getGames,\n  createGame,\n  updateGame,\n  deleteGame,\n  getPairs,\n} from \"../lib/database\";\n\ninterface MatchScoreEditorProps {\n  match: Match;\n  onClose: () => void;\n  onMatchFinish: () => void;\n}\n\nexport const MatchScoreEditor: React.FC<MatchScoreEditorProps> = ({\n  match,\n  onClose,\n  onMatchFinish,\n}) => {\n  const [games, setGames] = useState<Game[]>([]);\n  const [pairs, setPairs] = useState<Pair[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string>(\"\");\n\n  // Cargar juegos y parejas al montar el componente\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        console.log(\"🔄 Cargando datos del editor de marcador...\");\n\n        // Cargar juegos del partido\n        const matchGames = await getGames(match.id);\n        console.log(`📊 Juegos cargados: ${matchGames.length}`);\n        setGames(matchGames);\n\n        // Cargar parejas del torneo\n        const allPairs = await getPairs(match.tournament_id);\n        console.log(`👥 Parejas cargadas: ${allPairs.length}`);\n        setPairs(allPairs);\n      } catch (err) {\n        console.error(\"❌ Error cargando datos:\", err);\n        setError(\"Error al cargar los datos\");\n      }\n    };\n\n    loadData();\n  }, [match.id, match.tournament_id]);\n\n  // Agregar nuevo juego\n  const addGame = async () => {\n    try {\n      setLoading(true);\n      setError(\"\");\n\n      console.log(\n        `➕ Agregando juego ${games.length + 1} al partido ${match.id}`\n      );\n\n      const newGame = await createGame(match.id, games.length + 1);\n      console.log(`✅ Juego creado: ${newGame.id}`);\n\n      setGames((prevGames) => {\n        const updatedGames = [...prevGames, newGame];\n        console.log(\n          `📊 Total de juegos después de agregar: ${updatedGames.length}`\n        );\n        return updatedGames;\n      });\n    } catch (err) {\n      console.error(\"❌ Error agregando juego:\", err);\n      setError(\"Error al agregar juego\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // CORREGIR puntuación de un juego específico (NO acumula estadísticas)\n  const correctGameScore = async (\n    gameId: string,\n    pair1Games: number,\n    pair2Games: number,\n    isTieBreak: boolean = false\n  ) => {\n    try {\n      console.log(\n        `🔄 CORRIGIENDO juego ${gameId}: ${pair1Games}-${pair2Games}`\n      );\n      console.log(`📊 Juegos antes de corregir: ${games.length}`);\n\n      // SOLO actualizar el juego en la base de datos\n      await updateGame(gameId, {\n        pair1_games: pair1Games,\n        pair2_games: pair2Games,\n        is_tie_break: isTieBreak,\n      });\n\n      // Actualizar estado local\n      setGames((prevGames) => {\n        const updatedGames = prevGames.map((game) =>\n          game.id === gameId\n            ? {\n                ...game,\n                pair1_games: pair1Games,\n                pair2_games: pair2Games,\n                is_tie_break: isTieBreak,\n              }\n            : game\n        );\n\n        console.log(`📊 Juegos después de corregir: ${updatedGames.length}`);\n        console.log(\n          `✅ Juego ${gameId} corregido correctamente - NO se acumularon estadísticas`\n        );\n\n        return updatedGames;\n      });\n\n      // CRÍTICO: NO llamar a onMatchFinish() aquí\n      // Solo se llama cuando se finaliza el partido\n      console.log(\"🚫 NO se llama onMatchFinish() al corregir juego\");\n    } catch (err) {\n      console.error(\"❌ Error corrigiendo juego:\", err);\n      setError(\"Error al corregir puntuación\");\n    }\n  };\n\n  // Eliminar juego\n  const removeGame = async (gameId: string) => {\n    try {\n      setLoading(true);\n      setError(\"\");\n\n      console.log(`🗑️ Eliminando juego ${gameId}`);\n\n      await deleteGame(gameId);\n\n      setGames((prevGames) => {\n        const updatedGames = prevGames.filter((game) => game.id !== gameId);\n        console.log(`📊 Juegos después de eliminar: ${updatedGames.length}`);\n        return updatedGames;\n      });\n\n      // CRÍTICO: NO llamar a onMatchFinish() aquí\n      console.log(\"🚫 NO se llama onMatchFinish() al eliminar juego\");\n    } catch (err) {\n      console.error(\"❌ Error eliminando juego:\", err);\n      setError(\"Error al eliminar juego\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Cambiar tipo de juego (normal/tie-break)\n  const toggleTieBreak = async (gameId: string) => {\n    const game = games.find((g) => g.id === gameId);\n    if (game) {\n      await correctGameScore(\n        gameId,\n        game.pair1_games,\n        game.pair2_games,\n        !game.is_tie_break\n      );\n    }\n  };\n\n  // RECALCULAR todas las estadísticas del torneo desde cero\n  const recalculateAllTournamentStatistics = async () => {\n    try {\n      console.log(\"🔄 RECALCULANDO todas las estadísticas del torneo...\");\n\n      // Obtener todos los partidos del torneo\n      const { getMatches } = await import(\"../lib/database\");\n      const allMatches = await getMatches(match.tournament_id);\n      const finishedMatches = allMatches.filter((m) => m.is_finished);\n\n      console.log(\n        `📊 Partidos finalizados encontrados: ${finishedMatches.length}`\n      );\n\n      // Resetear todas las estadísticas de las parejas a cero\n      const { updatePair } = await import(\"../lib/database\");\n      for (const pair of pairs) {\n        await updatePair(pair.id, {\n          games_won: 0,\n          sets_won: 0,\n          points: 0,\n          matches_played: 0,\n        });\n        console.log(\n          `🔄 Reseteadas estadísticas de ${pair.player1?.name} y ${pair.player2?.name}`\n        );\n      }\n\n      // Recalcular estadísticas de cada partido finalizado\n      for (const finishedMatch of finishedMatches) {\n        const matchGames = await getGames(finishedMatch.id);\n\n        let pair1TotalPoints = 0;\n        let pair2TotalPoints = 0;\n        let pair1GamesWon = 0;\n        let pair2GamesWon = 0;\n        let pair1SetsWon = 0;\n        let pair2SetsWon = 0;\n\n        // Calcular estadísticas del partido\n        matchGames.forEach((game) => {\n          if (game.is_tie_break) {\n            // Tie-break\n            if (game.tie_break_pair1_points > game.tie_break_pair2_points) {\n              pair1GamesWon++;\n            } else if (\n              game.tie_break_pair2_points > game.tie_break_pair1_points\n            ) {\n              pair2GamesWon++;\n            }\n            pair1TotalPoints += game.tie_break_pair1_points || 0;\n            pair2TotalPoints += game.tie_break_pair2_points || 0;\n          } else {\n            // Juego normal\n            if (game.pair1_games > game.pair2_games) {\n              pair1GamesWon++;\n            } else if (game.pair2_games > game.pair1_games) {\n              pair2GamesWon++;\n            }\n            pair1TotalPoints += game.pair1_games;\n            pair2TotalPoints += game.pair2_games;\n\n            // Sets (6 puntos = 1 set)\n            if (game.pair1_games >= 6) {\n              pair1SetsWon++;\n            }\n            if (game.pair2_games >= 6) {\n              pair2SetsWon++;\n            }\n          }\n        });\n\n        // Acumular estadísticas en las parejas\n        const pair1 = pairs.find((p) => p.id === finishedMatch.pair1_id);\n        const pair2 = pairs.find((p) => p.id === finishedMatch.pair2_id);\n\n        if (pair1) {\n          const currentPair1 = await getPairs(match.tournament_id);\n          const updatedPair1 = currentPair1.find((p) => p.id === pair1.id);\n          if (updatedPair1) {\n            await updatePair(pair1.id, {\n              games_won: updatedPair1.games_won + pair1GamesWon,\n              sets_won: updatedPair1.sets_won + pair1SetsWon,\n              points: updatedPair1.points + pair1TotalPoints,\n              matches_played: updatedPair1.matches_played + 1,\n            });\n          }\n        }\n\n        if (pair2) {\n          const currentPair2 = await getPairs(match.tournament_id);\n          const updatedPair2 = currentPair2.find((p) => p.id === pair2.id);\n          if (updatedPair2) {\n            await updatePair(pair2.id, {\n              games_won: updatedPair2.games_won + pair2GamesWon,\n              sets_won: updatedPair2.sets_won + pair2SetsWon,\n              points: updatedPair2.points + pair2TotalPoints,\n              matches_played: updatedPair2.matches_played + 1,\n            });\n          }\n        }\n\n        console.log(`✅ Partido ${finishedMatch.id} recalculado`);\n      }\n\n      console.log(\n        \"✅ Todas las estadísticas del torneo recalculadas correctamente\"\n      );\n    } catch (err) {\n      console.error(\"❌ Error recalculando estadísticas:\", err);\n      setError(\"Error al recalcular estadísticas\");\n    }\n  };\n\n  // FINALIZAR partido (recalcula todas las estadísticas)\n  const finishMatch = async () => {\n    try {\n      setLoading(true);\n      setError(\"\");\n\n      console.log(\"🏆 FINALIZANDO partido...\");\n\n      // Calcular estadísticas del partido actual\n      let pair1TotalPoints = 0;\n      let pair2TotalPoints = 0;\n      let pair1GamesWon = 0;\n      let pair2GamesWon = 0;\n      let pair1SetsWon = 0;\n      let pair2SetsWon = 0;\n\n      games.forEach((game, index) => {\n        console.log(\n          `📊 Procesando juego ${index + 1}: ${game.pair1_games}-${\n            game.pair2_games\n          }`\n        );\n\n        if (game.is_tie_break) {\n          // Tie-break\n          if (game.tie_break_pair1_points > game.tie_break_pair2_points) {\n            pair1GamesWon++;\n          } else if (\n            game.tie_break_pair2_points > game.tie_break_pair1_points\n          ) {\n            pair2GamesWon++;\n          }\n          pair1TotalPoints += game.tie_break_pair1_points || 0;\n          pair2TotalPoints += game.tie_break_pair2_points || 0;\n        } else {\n          // Juego normal\n          if (game.pair1_games > game.pair2_games) {\n            pair1GamesWon++;\n          } else if (game.pair2_games > game.pair1_games) {\n            pair2GamesWon++;\n          }\n          pair1TotalPoints += game.pair1_games;\n          pair2TotalPoints += game.pair2_games;\n\n          // Sets (6 puntos = 1 set)\n          if (game.pair1_games >= 6) {\n            pair1SetsWon++;\n          }\n          if (game.pair2_games >= 6) {\n            pair2SetsWon++;\n          }\n        }\n      });\n\n      console.log(\"📊 Estadísticas finales del partido:\");\n      console.log(\n        `📊 Pareja 1: ${pair1GamesWon} juegos, ${pair1SetsWon} sets, ${pair1TotalPoints} puntos`\n      );\n      console.log(\n        `📊 Pareja 2: ${pair2GamesWon} juegos, ${pair2SetsWon} sets, ${pair2TotalPoints} puntos`\n      );\n\n      // Determinar ganador\n      let winnerId: string | undefined;\n      const isTie = pair1TotalPoints === pair2TotalPoints;\n\n      if (isTie) {\n        winnerId = undefined;\n        console.log(\"🤝 Partido terminó en EMPATE\");\n      } else if (pair1TotalPoints > pair2TotalPoints) {\n        winnerId = match.pair1_id;\n        console.log(\"🏆 Pareja 1 gana por puntos totales\");\n      } else {\n        winnerId = match.pair2_id;\n        console.log(\"🏆 Pareja 2 gana por puntos totales\");\n      }\n\n      // Marcar partido como finalizado\n      const { updateMatch } = await import(\"../lib/database\");\n      await updateMatch(match.id, {\n        winner_id: winnerId,\n        is_finished: true,\n      });\n\n      console.log(\"✅ Partido finalizado correctamente\");\n\n      // RECALCULAR todas las estadísticas del torneo\n      await recalculateAllTournamentStatistics();\n\n      // Llamar onMatchFinish() para actualizar tabla\n      console.log(\n        \"🏆 Llamando onMatchFinish() para actualizar tabla de clasificación\"\n      );\n      onMatchFinish();\n      onClose();\n    } catch (err) {\n      console.error(\"❌ Error finalizando partido:\", err);\n      setError(\"Error al finalizar partido\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Obtener nombres de pareja\n  const getPairNames = (pairId: string) => {\n    const pair = pairs.find((p) => p.id === pairId);\n    if (pair) {\n      return `${pair.player1?.name || \"Jugador 1\"} y ${\n        pair.player2?.name || \"Jugador 2\"\n      }`;\n    }\n    return \"Pareja desconocida\";\n  };\n\n  return (\n    <div className=\"match-score-editor-overlay\">\n      <div className=\"match-score-editor-modal\">\n        {/* Header */}\n        <div className=\"match-score-editor-header\">\n          <div className=\"match-score-editor-title\">\n            <span className=\"match-score-editor-icon\">🎾</span>\n            <h3>Editor de Marcador</h3>\n          </div>\n          <button className=\"match-score-editor-close-btn\" onClick={onClose}>\n            ✕\n          </button>\n        </div>\n\n        {/* Contenido */}\n        <div className=\"match-score-editor-content\">\n          {/* Información del partido */}\n          <div className=\"match-score-editor-info\">\n            <h4>\n              Partido {match.court} - Ronda {match.round}\n            </h4>\n            <div className=\"match-score-editor-pairs\">\n              <div className=\"match-score-editor-pair\">\n                <span className=\"match-score-editor-pair-label\">\n                  🏆 Pareja 1:\n                </span>\n                <span className=\"match-score-editor-pair-names\">\n                  {getPairNames(match.pair1_id)}\n                </span>\n              </div>\n              <div className=\"match-score-editor-pair\">\n                <span className=\"match-score-editor-pair-label\">\n                  🏆 Pareja 2:\n                </span>\n                <span className=\"match-score-editor-pair-names\">\n                  {getPairNames(match.pair2_id)}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Reglas */}\n          <div className=\"match-score-editor-rules\">\n            <h5>📋 Reglas del Juego:</h5>\n            <ul>\n              <li>\n                <strong>Juegos:</strong> La pareja que haga más puntos gana el\n                juego\n              </li>\n              <li>\n                <strong>Sets:</strong> La pareja que llegue a 6 puntos gana 1\n                set\n              </li>\n              <li>\n                <strong>Empates:</strong> Si ambas parejas tienen los mismos\n                puntos, es empate\n              </li>\n              <li>\n                <strong>Tie-Breaks:</strong> Se pueden activar para desempates\n                especiales\n              </li>\n            </ul>\n          </div>\n\n          {/* Sección de juegos */}\n          <div className=\"match-score-editor-games-section\">\n            <div className=\"match-score-editor-games-header\">\n              <h5>🎾 Juegos ({games.length})</h5>\n              <button\n                className=\"match-score-editor-add-game-btn\"\n                onClick={addGame}\n                disabled={loading}\n              >\n                + Agregar Juego\n              </button>\n            </div>\n\n            {games.length === 0 ? (\n              <div className=\"match-score-editor-no-games\">\n                <p>\n                  No hay juegos registrados. Haz clic en \"Agregar Juego\" para\n                  comenzar.\n                </p>\n              </div>\n            ) : (\n              <div className=\"match-score-editor-games-list\">\n                {games.map((game, index) => (\n                  <div key={game.id} className=\"match-score-editor-game-card\">\n                    <div className=\"match-score-editor-game-header\">\n                      <h6>Juego {index + 1}</h6>\n                      <div className=\"match-score-editor-game-actions\">\n                        <button\n                          className=\"match-score-editor-tie-break-btn\"\n                          onClick={() => toggleTieBreak(game.id)}\n                        >\n                          {game.is_tie_break ? \"🔗 Tie-Break\" : \"🔗 Normal\"}\n                        </button>\n                        <button\n                          className=\"match-score-editor-remove-game-btn\"\n                          onClick={() => removeGame(game.id)}\n                        >\n                          🗑️ Eliminar\n                        </button>\n                      </div>\n                    </div>\n\n                    <div className=\"match-score-editor-game-scores\">\n                      <div className=\"match-score-editor-score-input\">\n                        <label className=\"match-score-editor-pair-name-label\">\n                          {getPairNames(match.pair1_id)}\n                        </label>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          value={game.pair1_games}\n                          onChange={(e) =>\n                            correctGameScore(\n                              game.id,\n                              parseInt(e.target.value) || 0,\n                              game.pair2_games,\n                              game.is_tie_break\n                            )\n                          }\n                        />\n                      </div>\n\n                      <div className=\"match-score-editor-score-separator\">\n                        -\n                      </div>\n\n                      <div className=\"match-score-editor-score-input\">\n                        <label className=\"match-score-editor-pair-name-label\">\n                          {getPairNames(match.pair2_id)}\n                        </label>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          value={game.pair2_games}\n                          onChange={(e) =>\n                            correctGameScore(\n                              game.id,\n                              game.pair1_games,\n                              parseInt(e.target.value) || 0,\n                              game.is_tie_break\n                            )\n                          }\n                        />\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Mensaje de error */}\n          {error && (\n            <div className=\"match-score-editor-error\">\n              <p>❌ {error}</p>\n            </div>\n          )}\n\n          {/* Botones de acción */}\n          <div className=\"match-score-editor-actions\">\n            <button\n              className=\"match-score-editor-finish-btn\"\n              onClick={finishMatch}\n              disabled={loading || games.length === 0}\n            >\n              {loading ? \"⏳ Finalizando...\" : \"🏆 Finalizar Partido\"}\n            </button>\n            <button className=\"match-score-editor-cancel-btn\" onClick={onClose}>\n              ❌ Cancelar\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAElD,OACEC,QAAQ,CACRC,UAAU,CACVC,UAAU,CACVC,UAAU,CACVC,QAAQ,KACH,iBAAiB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAQzB,MAAO,MAAM,CAAAC,gBAAiD,CAAGC,IAAA,EAI3D,IAJ4D,CAChEC,KAAK,CACLC,OAAO,CACPC,aACF,CAAC,CAAAH,IAAA,CACC,KAAM,CAACI,KAAK,CAAEC,QAAQ,CAAC,CAAGjB,QAAQ,CAAS,EAAE,CAAC,CAC9C,KAAM,CAACkB,KAAK,CAAEC,QAAQ,CAAC,CAAGnB,QAAQ,CAAS,EAAE,CAAC,CAC9C,KAAM,CAACoB,OAAO,CAAEC,UAAU,CAAC,CAAGrB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACsB,KAAK,CAAEC,QAAQ,CAAC,CAAGvB,QAAQ,CAAS,EAAE,CAAC,CAE9C;AACAC,SAAS,CAAC,IAAM,CACd,KAAM,CAAAuB,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CACFC,OAAO,CAACC,GAAG,CAAC,6CAA6C,CAAC,CAE1D;AACA,KAAM,CAAAC,UAAU,CAAG,KAAM,CAAAzB,QAAQ,CAACW,KAAK,CAACe,EAAE,CAAC,CAC3CH,OAAO,CAACC,GAAG,CAAC,uBAAuBC,UAAU,CAACE,MAAM,EAAE,CAAC,CACvDZ,QAAQ,CAACU,UAAU,CAAC,CAEpB;AACA,KAAM,CAAAG,QAAQ,CAAG,KAAM,CAAAxB,QAAQ,CAACO,KAAK,CAACkB,aAAa,CAAC,CACpDN,OAAO,CAACC,GAAG,CAAC,wBAAwBI,QAAQ,CAACD,MAAM,EAAE,CAAC,CACtDV,QAAQ,CAACW,QAAQ,CAAC,CACpB,CAAE,MAAOE,GAAG,CAAE,CACZP,OAAO,CAACH,KAAK,CAAC,yBAAyB,CAAEU,GAAG,CAAC,CAC7CT,QAAQ,CAAC,2BAA2B,CAAC,CACvC,CACF,CAAC,CAEDC,QAAQ,CAAC,CAAC,CACZ,CAAC,CAAE,CAACX,KAAK,CAACe,EAAE,CAAEf,KAAK,CAACkB,aAAa,CAAC,CAAC,CAEnC;AACA,KAAM,CAAAE,OAAO,CAAG,KAAAA,CAAA,GAAY,CAC1B,GAAI,CACFZ,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CAEZE,OAAO,CAACC,GAAG,CACT,qBAAqBV,KAAK,CAACa,MAAM,CAAG,CAAC,eAAehB,KAAK,CAACe,EAAE,EAC9D,CAAC,CAED,KAAM,CAAAM,OAAO,CAAG,KAAM,CAAA/B,UAAU,CAACU,KAAK,CAACe,EAAE,CAAEZ,KAAK,CAACa,MAAM,CAAG,CAAC,CAAC,CAC5DJ,OAAO,CAACC,GAAG,CAAC,mBAAmBQ,OAAO,CAACN,EAAE,EAAE,CAAC,CAE5CX,QAAQ,CAAEkB,SAAS,EAAK,CACtB,KAAM,CAAAC,YAAY,CAAG,CAAC,GAAGD,SAAS,CAAED,OAAO,CAAC,CAC5CT,OAAO,CAACC,GAAG,CACT,0CAA0CU,YAAY,CAACP,MAAM,EAC/D,CAAC,CACD,MAAO,CAAAO,YAAY,CACrB,CAAC,CAAC,CACJ,CAAE,MAAOJ,GAAG,CAAE,CACZP,OAAO,CAACH,KAAK,CAAC,0BAA0B,CAAEU,GAAG,CAAC,CAC9CT,QAAQ,CAAC,wBAAwB,CAAC,CACpC,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAAgB,gBAAgB,CAAG,cAAAA,CACvBC,MAAc,CACdC,UAAkB,CAClBC,UAAkB,CAEf,IADH,CAAAC,UAAmB,CAAAC,SAAA,CAAAb,MAAA,IAAAa,SAAA,MAAAC,SAAA,CAAAD,SAAA,IAAG,KAAK,CAE3B,GAAI,CACFjB,OAAO,CAACC,GAAG,CACT,wBAAwBY,MAAM,KAAKC,UAAU,IAAIC,UAAU,EAC7D,CAAC,CACDf,OAAO,CAACC,GAAG,CAAC,gCAAgCV,KAAK,CAACa,MAAM,EAAE,CAAC,CAE3D;AACA,KAAM,CAAAzB,UAAU,CAACkC,MAAM,CAAE,CACvBM,WAAW,CAAEL,UAAU,CACvBM,WAAW,CAAEL,UAAU,CACvBM,YAAY,CAAEL,UAChB,CAAC,CAAC,CAEF;AACAxB,QAAQ,CAAEkB,SAAS,EAAK,CACtB,KAAM,CAAAC,YAAY,CAAGD,SAAS,CAACY,GAAG,CAAEC,IAAI,EACtCA,IAAI,CAACpB,EAAE,GAAKU,MAAM,CACd,CACE,GAAGU,IAAI,CACPJ,WAAW,CAAEL,UAAU,CACvBM,WAAW,CAAEL,UAAU,CACvBM,YAAY,CAAEL,UAChB,CAAC,CACDO,IACN,CAAC,CAEDvB,OAAO,CAACC,GAAG,CAAC,kCAAkCU,YAAY,CAACP,MAAM,EAAE,CAAC,CACpEJ,OAAO,CAACC,GAAG,CACT,WAAWY,MAAM,0DACnB,CAAC,CAED,MAAO,CAAAF,YAAY,CACrB,CAAC,CAAC,CAEF;AACA;AACAX,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC,CACjE,CAAE,MAAOM,GAAG,CAAE,CACZP,OAAO,CAACH,KAAK,CAAC,4BAA4B,CAAEU,GAAG,CAAC,CAChDT,QAAQ,CAAC,8BAA8B,CAAC,CAC1C,CACF,CAAC,CAED;AACA,KAAM,CAAA0B,UAAU,CAAG,KAAO,CAAAX,MAAc,EAAK,CAC3C,GAAI,CACFjB,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CAEZE,OAAO,CAACC,GAAG,CAAC,wBAAwBY,MAAM,EAAE,CAAC,CAE7C,KAAM,CAAAjC,UAAU,CAACiC,MAAM,CAAC,CAExBrB,QAAQ,CAAEkB,SAAS,EAAK,CACtB,KAAM,CAAAC,YAAY,CAAGD,SAAS,CAACe,MAAM,CAAEF,IAAI,EAAKA,IAAI,CAACpB,EAAE,GAAKU,MAAM,CAAC,CACnEb,OAAO,CAACC,GAAG,CAAC,kCAAkCU,YAAY,CAACP,MAAM,EAAE,CAAC,CACpE,MAAO,CAAAO,YAAY,CACrB,CAAC,CAAC,CAEF;AACAX,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC,CACjE,CAAE,MAAOM,GAAG,CAAE,CACZP,OAAO,CAACH,KAAK,CAAC,2BAA2B,CAAEU,GAAG,CAAC,CAC/CT,QAAQ,CAAC,yBAAyB,CAAC,CACrC,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAA8B,cAAc,CAAG,KAAO,CAAAb,MAAc,EAAK,CAC/C,KAAM,CAAAU,IAAI,CAAGhC,KAAK,CAACoC,IAAI,CAAEC,CAAC,EAAKA,CAAC,CAACzB,EAAE,GAAKU,MAAM,CAAC,CAC/C,GAAIU,IAAI,CAAE,CACR,KAAM,CAAAX,gBAAgB,CACpBC,MAAM,CACNU,IAAI,CAACJ,WAAW,CAChBI,IAAI,CAACH,WAAW,CAChB,CAACG,IAAI,CAACF,YACR,CAAC,CACH,CACF,CAAC,CAED;AACA,KAAM,CAAAQ,kCAAkC,CAAG,KAAAA,CAAA,GAAY,CACrD,GAAI,CACF7B,OAAO,CAACC,GAAG,CAAC,sDAAsD,CAAC,CAEnE;AACA,KAAM,CAAE6B,UAAW,CAAC,CAAG,KAAM,OAAM,CAAC,iBAAiB,CAAC,CACtD,KAAM,CAAAC,UAAU,CAAG,KAAM,CAAAD,UAAU,CAAC1C,KAAK,CAACkB,aAAa,CAAC,CACxD,KAAM,CAAA0B,eAAe,CAAGD,UAAU,CAACN,MAAM,CAAEQ,CAAC,EAAKA,CAAC,CAACC,WAAW,CAAC,CAE/DlC,OAAO,CAACC,GAAG,CACT,wCAAwC+B,eAAe,CAAC5B,MAAM,EAChE,CAAC,CAED;AACA,KAAM,CAAE+B,UAAW,CAAC,CAAG,KAAM,OAAM,CAAC,iBAAiB,CAAC,CACtD,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAA3C,KAAK,CAAE,KAAA4C,YAAA,CAAAC,aAAA,CACxB,KAAM,CAAAH,UAAU,CAACC,IAAI,CAACjC,EAAE,CAAE,CACxBoC,SAAS,CAAE,CAAC,CACZC,QAAQ,CAAE,CAAC,CACXC,MAAM,CAAE,CAAC,CACTC,cAAc,CAAE,CAClB,CAAC,CAAC,CACF1C,OAAO,CAACC,GAAG,CACT,kCAAAoC,YAAA,CAAiCD,IAAI,CAACO,OAAO,UAAAN,YAAA,iBAAZA,YAAA,CAAcO,IAAI,OAAAN,aAAA,CAAMF,IAAI,CAACS,OAAO,UAAAP,aAAA,iBAAZA,aAAA,CAAcM,IAAI,EAC7E,CAAC,CACH,CAEA;AACA,IAAK,KAAM,CAAAE,aAAa,GAAI,CAAAd,eAAe,CAAE,CAC3C,KAAM,CAAA9B,UAAU,CAAG,KAAM,CAAAzB,QAAQ,CAACqE,aAAa,CAAC3C,EAAE,CAAC,CAEnD,GAAI,CAAA4C,gBAAgB,CAAG,CAAC,CACxB,GAAI,CAAAC,gBAAgB,CAAG,CAAC,CACxB,GAAI,CAAAC,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,YAAY,CAAG,CAAC,CACpB,GAAI,CAAAC,YAAY,CAAG,CAAC,CAEpB;AACAlD,UAAU,CAACmD,OAAO,CAAE9B,IAAI,EAAK,CAC3B,GAAIA,IAAI,CAACF,YAAY,CAAE,CACrB;AACA,GAAIE,IAAI,CAAC+B,sBAAsB,CAAG/B,IAAI,CAACgC,sBAAsB,CAAE,CAC7DN,aAAa,EAAE,CACjB,CAAC,IAAM,IACL1B,IAAI,CAACgC,sBAAsB,CAAGhC,IAAI,CAAC+B,sBAAsB,CACzD,CACAJ,aAAa,EAAE,CACjB,CACAH,gBAAgB,EAAIxB,IAAI,CAAC+B,sBAAsB,EAAI,CAAC,CACpDN,gBAAgB,EAAIzB,IAAI,CAACgC,sBAAsB,EAAI,CAAC,CACtD,CAAC,IAAM,CACL;AACA,GAAIhC,IAAI,CAACJ,WAAW,CAAGI,IAAI,CAACH,WAAW,CAAE,CACvC6B,aAAa,EAAE,CACjB,CAAC,IAAM,IAAI1B,IAAI,CAACH,WAAW,CAAGG,IAAI,CAACJ,WAAW,CAAE,CAC9C+B,aAAa,EAAE,CACjB,CACAH,gBAAgB,EAAIxB,IAAI,CAACJ,WAAW,CACpC6B,gBAAgB,EAAIzB,IAAI,CAACH,WAAW,CAEpC;AACA,GAAIG,IAAI,CAACJ,WAAW,EAAI,CAAC,CAAE,CACzBgC,YAAY,EAAE,CAChB,CACA,GAAI5B,IAAI,CAACH,WAAW,EAAI,CAAC,CAAE,CACzBgC,YAAY,EAAE,CAChB,CACF,CACF,CAAC,CAAC,CAEF;AACA,KAAM,CAAAI,KAAK,CAAG/D,KAAK,CAACkC,IAAI,CAAE8B,CAAC,EAAKA,CAAC,CAACtD,EAAE,GAAK2C,aAAa,CAACY,QAAQ,CAAC,CAChE,KAAM,CAAAC,KAAK,CAAGlE,KAAK,CAACkC,IAAI,CAAE8B,CAAC,EAAKA,CAAC,CAACtD,EAAE,GAAK2C,aAAa,CAACc,QAAQ,CAAC,CAEhE,GAAIJ,KAAK,CAAE,CACT,KAAM,CAAAK,YAAY,CAAG,KAAM,CAAAhF,QAAQ,CAACO,KAAK,CAACkB,aAAa,CAAC,CACxD,KAAM,CAAAwD,YAAY,CAAGD,YAAY,CAAClC,IAAI,CAAE8B,CAAC,EAAKA,CAAC,CAACtD,EAAE,GAAKqD,KAAK,CAACrD,EAAE,CAAC,CAChE,GAAI2D,YAAY,CAAE,CAChB,KAAM,CAAA3B,UAAU,CAACqB,KAAK,CAACrD,EAAE,CAAE,CACzBoC,SAAS,CAAEuB,YAAY,CAACvB,SAAS,CAAGU,aAAa,CACjDT,QAAQ,CAAEsB,YAAY,CAACtB,QAAQ,CAAGW,YAAY,CAC9CV,MAAM,CAAEqB,YAAY,CAACrB,MAAM,CAAGM,gBAAgB,CAC9CL,cAAc,CAAEoB,YAAY,CAACpB,cAAc,CAAG,CAChD,CAAC,CAAC,CACJ,CACF,CAEA,GAAIiB,KAAK,CAAE,CACT,KAAM,CAAAI,YAAY,CAAG,KAAM,CAAAlF,QAAQ,CAACO,KAAK,CAACkB,aAAa,CAAC,CACxD,KAAM,CAAA0D,YAAY,CAAGD,YAAY,CAACpC,IAAI,CAAE8B,CAAC,EAAKA,CAAC,CAACtD,EAAE,GAAKwD,KAAK,CAACxD,EAAE,CAAC,CAChE,GAAI6D,YAAY,CAAE,CAChB,KAAM,CAAA7B,UAAU,CAACwB,KAAK,CAACxD,EAAE,CAAE,CACzBoC,SAAS,CAAEyB,YAAY,CAACzB,SAAS,CAAGW,aAAa,CACjDV,QAAQ,CAAEwB,YAAY,CAACxB,QAAQ,CAAGY,YAAY,CAC9CX,MAAM,CAAEuB,YAAY,CAACvB,MAAM,CAAGO,gBAAgB,CAC9CN,cAAc,CAAEsB,YAAY,CAACtB,cAAc,CAAG,CAChD,CAAC,CAAC,CACJ,CACF,CAEA1C,OAAO,CAACC,GAAG,CAAC,aAAa6C,aAAa,CAAC3C,EAAE,cAAc,CAAC,CAC1D,CAEAH,OAAO,CAACC,GAAG,CACT,gEACF,CAAC,CACH,CAAE,MAAOM,GAAG,CAAE,CACZP,OAAO,CAACH,KAAK,CAAC,oCAAoC,CAAEU,GAAG,CAAC,CACxDT,QAAQ,CAAC,kCAAkC,CAAC,CAC9C,CACF,CAAC,CAED;AACA,KAAM,CAAAmE,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACFrE,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,EAAE,CAAC,CAEZE,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC,CAExC;AACA,GAAI,CAAA8C,gBAAgB,CAAG,CAAC,CACxB,GAAI,CAAAC,gBAAgB,CAAG,CAAC,CACxB,GAAI,CAAAC,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,YAAY,CAAG,CAAC,CACpB,GAAI,CAAAC,YAAY,CAAG,CAAC,CAEpB7D,KAAK,CAAC8D,OAAO,CAAC,CAAC9B,IAAI,CAAE2C,KAAK,GAAK,CAC7BlE,OAAO,CAACC,GAAG,CACT,uBAAuBiE,KAAK,CAAG,CAAC,KAAK3C,IAAI,CAACJ,WAAW,IACnDI,IAAI,CAACH,WAAW,EAEpB,CAAC,CAED,GAAIG,IAAI,CAACF,YAAY,CAAE,CACrB;AACA,GAAIE,IAAI,CAAC+B,sBAAsB,CAAG/B,IAAI,CAACgC,sBAAsB,CAAE,CAC7DN,aAAa,EAAE,CACjB,CAAC,IAAM,IACL1B,IAAI,CAACgC,sBAAsB,CAAGhC,IAAI,CAAC+B,sBAAsB,CACzD,CACAJ,aAAa,EAAE,CACjB,CACAH,gBAAgB,EAAIxB,IAAI,CAAC+B,sBAAsB,EAAI,CAAC,CACpDN,gBAAgB,EAAIzB,IAAI,CAACgC,sBAAsB,EAAI,CAAC,CACtD,CAAC,IAAM,CACL;AACA,GAAIhC,IAAI,CAACJ,WAAW,CAAGI,IAAI,CAACH,WAAW,CAAE,CACvC6B,aAAa,EAAE,CACjB,CAAC,IAAM,IAAI1B,IAAI,CAACH,WAAW,CAAGG,IAAI,CAACJ,WAAW,CAAE,CAC9C+B,aAAa,EAAE,CACjB,CACAH,gBAAgB,EAAIxB,IAAI,CAACJ,WAAW,CACpC6B,gBAAgB,EAAIzB,IAAI,CAACH,WAAW,CAEpC;AACA,GAAIG,IAAI,CAACJ,WAAW,EAAI,CAAC,CAAE,CACzBgC,YAAY,EAAE,CAChB,CACA,GAAI5B,IAAI,CAACH,WAAW,EAAI,CAAC,CAAE,CACzBgC,YAAY,EAAE,CAChB,CACF,CACF,CAAC,CAAC,CAEFpD,OAAO,CAACC,GAAG,CAAC,sCAAsC,CAAC,CACnDD,OAAO,CAACC,GAAG,CACT,gBAAgBgD,aAAa,YAAYE,YAAY,UAAUJ,gBAAgB,SACjF,CAAC,CACD/C,OAAO,CAACC,GAAG,CACT,gBAAgBiD,aAAa,YAAYE,YAAY,UAAUJ,gBAAgB,SACjF,CAAC,CAED;AACA,GAAI,CAAAmB,QAA4B,CAChC,KAAM,CAAAC,KAAK,CAAGrB,gBAAgB,GAAKC,gBAAgB,CAEnD,GAAIoB,KAAK,CAAE,CACTD,QAAQ,CAAGjD,SAAS,CACpBlB,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC,CAC7C,CAAC,IAAM,IAAI8C,gBAAgB,CAAGC,gBAAgB,CAAE,CAC9CmB,QAAQ,CAAG/E,KAAK,CAACsE,QAAQ,CACzB1D,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC,CACpD,CAAC,IAAM,CACLkE,QAAQ,CAAG/E,KAAK,CAACwE,QAAQ,CACzB5D,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC,CACpD,CAEA;AACA,KAAM,CAAEoE,WAAY,CAAC,CAAG,KAAM,OAAM,CAAC,iBAAiB,CAAC,CACvD,KAAM,CAAAA,WAAW,CAACjF,KAAK,CAACe,EAAE,CAAE,CAC1BmE,SAAS,CAAEH,QAAQ,CACnBjC,WAAW,CAAE,IACf,CAAC,CAAC,CAEFlC,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC,CAEjD;AACA,KAAM,CAAA4B,kCAAkC,CAAC,CAAC,CAE1C;AACA7B,OAAO,CAACC,GAAG,CACT,oEACF,CAAC,CACDX,aAAa,CAAC,CAAC,CACfD,OAAO,CAAC,CAAC,CACX,CAAE,MAAOkB,GAAG,CAAE,CACZP,OAAO,CAACH,KAAK,CAAC,8BAA8B,CAAEU,GAAG,CAAC,CAClDT,QAAQ,CAAC,4BAA4B,CAAC,CACxC,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAA2E,YAAY,CAAIC,MAAc,EAAK,CACvC,KAAM,CAAApC,IAAI,CAAG3C,KAAK,CAACkC,IAAI,CAAE8B,CAAC,EAAKA,CAAC,CAACtD,EAAE,GAAKqE,MAAM,CAAC,CAC/C,GAAIpC,IAAI,CAAE,KAAAqC,aAAA,CAAAC,aAAA,CACR,MAAO,GAAG,EAAAD,aAAA,CAAArC,IAAI,CAACO,OAAO,UAAA8B,aAAA,iBAAZA,aAAA,CAAc7B,IAAI,GAAI,WAAW,MACzC,EAAA8B,aAAA,CAAAtC,IAAI,CAACS,OAAO,UAAA6B,aAAA,iBAAZA,aAAA,CAAc9B,IAAI,GAAI,WAAW,EACjC,CACJ,CACA,MAAO,oBAAoB,CAC7B,CAAC,CAED,mBACE7D,IAAA,QAAK4F,SAAS,CAAC,4BAA4B,CAAAC,QAAA,cACzC3F,KAAA,QAAK0F,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eAEvC3F,KAAA,QAAK0F,SAAS,CAAC,2BAA2B,CAAAC,QAAA,eACxC3F,KAAA,QAAK0F,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC7F,IAAA,SAAM4F,SAAS,CAAC,yBAAyB,CAAAC,QAAA,CAAC,cAAE,CAAM,CAAC,cACnD7F,IAAA,OAAA6F,QAAA,CAAI,oBAAkB,CAAI,CAAC,EACxB,CAAC,cACN7F,IAAA,WAAQ4F,SAAS,CAAC,8BAA8B,CAACE,OAAO,CAAExF,OAAQ,CAAAuF,QAAA,CAAC,QAEnE,CAAQ,CAAC,EACN,CAAC,cAGN3F,KAAA,QAAK0F,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eAEzC3F,KAAA,QAAK0F,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC3F,KAAA,OAAA2F,QAAA,EAAI,UACM,CAACxF,KAAK,CAAC0F,KAAK,CAAC,WAAS,CAAC1F,KAAK,CAAC2F,KAAK,EACxC,CAAC,cACL9F,KAAA,QAAK0F,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC3F,KAAA,QAAK0F,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC7F,IAAA,SAAM4F,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAAC,wBAEhD,CAAM,CAAC,cACP7F,IAAA,SAAM4F,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAC5CL,YAAY,CAACnF,KAAK,CAACsE,QAAQ,CAAC,CACzB,CAAC,EACJ,CAAC,cACNzE,KAAA,QAAK0F,SAAS,CAAC,yBAAyB,CAAAC,QAAA,eACtC7F,IAAA,SAAM4F,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAAC,wBAEhD,CAAM,CAAC,cACP7F,IAAA,SAAM4F,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAC5CL,YAAY,CAACnF,KAAK,CAACwE,QAAQ,CAAC,CACzB,CAAC,EACJ,CAAC,EACH,CAAC,EACH,CAAC,cAGN3E,KAAA,QAAK0F,SAAS,CAAC,0BAA0B,CAAAC,QAAA,eACvC7F,IAAA,OAAA6F,QAAA,CAAI,gCAAoB,CAAI,CAAC,cAC7B3F,KAAA,OAAA2F,QAAA,eACE3F,KAAA,OAAA2F,QAAA,eACE7F,IAAA,WAAA6F,QAAA,CAAQ,SAAO,CAAQ,CAAC,kDAE1B,EAAI,CAAC,cACL3F,KAAA,OAAA2F,QAAA,eACE7F,IAAA,WAAA6F,QAAA,CAAQ,OAAK,CAAQ,CAAC,8CAExB,EAAI,CAAC,cACL3F,KAAA,OAAA2F,QAAA,eACE7F,IAAA,WAAA6F,QAAA,CAAQ,UAAQ,CAAQ,CAAC,wDAE3B,EAAI,CAAC,cACL3F,KAAA,OAAA2F,QAAA,eACE7F,IAAA,WAAA6F,QAAA,CAAQ,aAAW,CAAQ,CAAC,gDAE9B,EAAI,CAAC,EACH,CAAC,EACF,CAAC,cAGN3F,KAAA,QAAK0F,SAAS,CAAC,kCAAkC,CAAAC,QAAA,eAC/C3F,KAAA,QAAK0F,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eAC9C3F,KAAA,OAAA2F,QAAA,EAAI,uBAAW,CAACrF,KAAK,CAACa,MAAM,CAAC,GAAC,EAAI,CAAC,cACnCrB,IAAA,WACE4F,SAAS,CAAC,iCAAiC,CAC3CE,OAAO,CAAErE,OAAQ,CACjBwE,QAAQ,CAAErF,OAAQ,CAAAiF,QAAA,CACnB,iBAED,CAAQ,CAAC,EACN,CAAC,CAELrF,KAAK,CAACa,MAAM,GAAK,CAAC,cACjBrB,IAAA,QAAK4F,SAAS,CAAC,6BAA6B,CAAAC,QAAA,cAC1C7F,IAAA,MAAA6F,QAAA,CAAG,yEAGH,CAAG,CAAC,CACD,CAAC,cAEN7F,IAAA,QAAK4F,SAAS,CAAC,+BAA+B,CAAAC,QAAA,CAC3CrF,KAAK,CAAC+B,GAAG,CAAC,CAACC,IAAI,CAAE2C,KAAK,gBACrBjF,KAAA,QAAmB0F,SAAS,CAAC,8BAA8B,CAAAC,QAAA,eACzD3F,KAAA,QAAK0F,SAAS,CAAC,gCAAgC,CAAAC,QAAA,eAC7C3F,KAAA,OAAA2F,QAAA,EAAI,QAAM,CAACV,KAAK,CAAG,CAAC,EAAK,CAAC,cAC1BjF,KAAA,QAAK0F,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eAC9C7F,IAAA,WACE4F,SAAS,CAAC,kCAAkC,CAC5CE,OAAO,CAAEA,CAAA,GAAMnD,cAAc,CAACH,IAAI,CAACpB,EAAE,CAAE,CAAAyE,QAAA,CAEtCrD,IAAI,CAACF,YAAY,CAAG,cAAc,CAAG,WAAW,CAC3C,CAAC,cACTtC,IAAA,WACE4F,SAAS,CAAC,oCAAoC,CAC9CE,OAAO,CAAEA,CAAA,GAAMrD,UAAU,CAACD,IAAI,CAACpB,EAAE,CAAE,CAAAyE,QAAA,CACpC,6BAED,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,cAEN3F,KAAA,QAAK0F,SAAS,CAAC,gCAAgC,CAAAC,QAAA,eAC7C3F,KAAA,QAAK0F,SAAS,CAAC,gCAAgC,CAAAC,QAAA,eAC7C7F,IAAA,UAAO4F,SAAS,CAAC,oCAAoC,CAAAC,QAAA,CAClDL,YAAY,CAACnF,KAAK,CAACsE,QAAQ,CAAC,CACxB,CAAC,cACR3E,IAAA,UACEkG,IAAI,CAAC,QAAQ,CACbC,GAAG,CAAC,GAAG,CACPC,KAAK,CAAE5D,IAAI,CAACJ,WAAY,CACxBiE,QAAQ,CAAGC,CAAC,EACVzE,gBAAgB,CACdW,IAAI,CAACpB,EAAE,CACPmF,QAAQ,CAACD,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,EAAI,CAAC,CAC7B5D,IAAI,CAACH,WAAW,CAChBG,IAAI,CAACF,YACP,CACD,CACF,CAAC,EACC,CAAC,cAENtC,IAAA,QAAK4F,SAAS,CAAC,oCAAoC,CAAAC,QAAA,CAAC,GAEpD,CAAK,CAAC,cAEN3F,KAAA,QAAK0F,SAAS,CAAC,gCAAgC,CAAAC,QAAA,eAC7C7F,IAAA,UAAO4F,SAAS,CAAC,oCAAoC,CAAAC,QAAA,CAClDL,YAAY,CAACnF,KAAK,CAACwE,QAAQ,CAAC,CACxB,CAAC,cACR7E,IAAA,UACEkG,IAAI,CAAC,QAAQ,CACbC,GAAG,CAAC,GAAG,CACPC,KAAK,CAAE5D,IAAI,CAACH,WAAY,CACxBgE,QAAQ,CAAGC,CAAC,EACVzE,gBAAgB,CACdW,IAAI,CAACpB,EAAE,CACPoB,IAAI,CAACJ,WAAW,CAChBmE,QAAQ,CAACD,CAAC,CAACE,MAAM,CAACJ,KAAK,CAAC,EAAI,CAAC,CAC7B5D,IAAI,CAACF,YACP,CACD,CACF,CAAC,EACC,CAAC,EACH,CAAC,GA7DEE,IAAI,CAACpB,EA8DV,CACN,CAAC,CACC,CACN,EACE,CAAC,CAGLN,KAAK,eACJd,IAAA,QAAK4F,SAAS,CAAC,0BAA0B,CAAAC,QAAA,cACvC3F,KAAA,MAAA2F,QAAA,EAAG,SAAE,CAAC/E,KAAK,EAAI,CAAC,CACb,CACN,cAGDZ,KAAA,QAAK0F,SAAS,CAAC,4BAA4B,CAAAC,QAAA,eACzC7F,IAAA,WACE4F,SAAS,CAAC,+BAA+B,CACzCE,OAAO,CAAEZ,WAAY,CACrBe,QAAQ,CAAErF,OAAO,EAAIJ,KAAK,CAACa,MAAM,GAAK,CAAE,CAAAwE,QAAA,CAEvCjF,OAAO,CAAG,kBAAkB,CAAG,sBAAsB,CAChD,CAAC,cACTZ,IAAA,WAAQ4F,SAAS,CAAC,+BAA+B,CAACE,OAAO,CAAExF,OAAQ,CAAAuF,QAAA,CAAC,iBAEpE,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,EACH,CAAC,CACH,CAAC,CAEV,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}